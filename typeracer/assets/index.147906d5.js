import{j as z,a as H,F as q,D as U,l as i,p as b,y as v,b as J,s as Q,K as V,S as X}from"./vendor.83355b46.js";const Y=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function l(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=l(e);fetch(e.href,n)}};Y();const c=z,m=H,K=q,M=U({}),A=()=>J(M),R=(t,s)=>{switch(s){case"increment":return t+1;case"decrement":return t-1;case"reset":return 0;default:throw new Error("Unexpected action")}},k=(t,s)=>t+s,Z=({children:t})=>{const[s,l]=i(0),[o,e]=b(R,0),[n,r]=b(k,0),[d,u]=b(k,0),[g,E]=b(R,0),[y,W]=i(!1),[f,N]=i([]),P=L=>N([...f,...L]),[w,I]=i(0),[S,G]=i(0);return v(()=>{I((2*d-g)/d*100),G(g/5*2*Math.min(w,1))},[o]),c(M.Provider,{value:{startTime:s,wordsCount:o,charCount:n,expectedCharCount:d,strokeCount:g,gameStopped:y,inputs:f,wpm:S,accuracy:w,mutateWordsCount:e,mutateCharCount:r,mutateExpectedCount:u,mutateStrokeCount:E,stopGame:()=>W(!0),startGame:()=>l(Date.now()/1e3),appendInputs:P},children:t})},_=()=>{const{wordsCount:t,charCount:s,expectedCharCount:l,strokeCount:o,wpm:e,accuracy:n}=A();return m(K,{children:[m("span",{children:["WPM: ",e.toFixed(2)," (",n.toFixed(2),"%)"]}),m("span",{children:[t,"/",l,"/",s,"/",o]})]})},j=({divRef:t,word:s,wordProgress:l,isProcessing:o})=>m("div",{ref:t,children:[s.split("").map((e,n)=>c("span",{className:o&&l.length>n?s[n]==l.charAt(n)?"text-success":"text-danger":"",children:l.length>n?l.charAt(n):e})),l.slice(s.length).split("").map(e=>c("span",{className:"text-danger",children:e})),c("span",{children:"\xA0"})]}),ee=({words:t,onProgress:s,frozen:l,removeWords:o})=>{const[e,n]=i(t[0]),[r,d]=i(""),[u,g]=i([]),[E,y]=i(0),W=14.35,f=Q(null),{startTime:N,startGame:P,mutateWordsCount:w,mutateCharCount:I,mutateExpectedCount:S,mutateStrokeCount:G,appendInputs:L,gameStopped:T}=A();return v(()=>{var a,x,p,F,O;if(N==0&&r.length>0&&P(),r[r.length-1]==" "&&r.length!=1){r.trim()==e&&w("increment"),I(r.length),S(e.length+1);let $=t.indexOf(e)+1;n(t[$]),d("");const B=(x=(a=f.current)==null?void 0:a.getBoundingClientRect().left)!=null?x:-1,D=(O=(F=(p=f.current)==null?void 0:p.nextElementSibling)==null?void 0:F.getBoundingClientRect().left)!=null?O:0;if(B>D){let C=0,h=f.current;for(;h;)C++,h=h.previousElementSibling;L([...u,r.trim()]),g([]),y(0),o(C)}else{g(h=>[...h,r.trim()]);let C;r.trim().length>e.length?C=r.length-1:C=e.length,y(h=>h+C+1)}}},[r]),m(K,{children:[c(V,{isDisabled:T,handleKeys:["alphabetic","backspace","space"],onKeyEvent:(a,x)=>{a=="space"&&(a=" "),a=="backspace"?d(p=>p.slice(0,p.length-1)):(G("increment"),d(p=>p+a)),console.log(r+a)}}),m("div",{className:"relative w-full h-[128px]",children:[c("div",{className:"border-l-4 border-l-grey border-opacity-75 h-[2rem] absolute animate-pulse transition-all",style:{left:(r.length+E)*W+"px"}}),m("div",{className:"flex flex-row font-mono select-none flex-wrap max-h-[128px] overflow-hidden text-2xl absolute",children:[t.slice(0,u.length).map((a,x)=>c(j,{word:a,wordProgress:u[x],isProcessing:!0})),c(j,{divRef:f,word:t[u.length],wordProgress:r.trim(),isProcessing:!0}),t.slice(u.length+1,u.length+50).map((a,x)=>c(j,{word:a,wordProgress:"",isProcessing:!1}))]})]})]})},te=()=>{const[t,s]=i(30),[l,o]=i(0),{startTime:e,stopGame:n}=A();return v(()=>{e!=0&&o(setInterval(()=>{s(r=>r-1)},1e3))},[e]),v(()=>{t>0||(n(),clearInterval(l))},[t]),c("div",{className:"font-retro",children:t})};function ne(t){let s=Math.floor(Math.random()*t.length);return t[s]}function re(){const[t,s]=i([]);v(()=>{async function o(){let e=await fetch("./words.txt");if(e.ok){let r=(await e.text()).split(`
`),d=[];for(let u=0;u<500;u++)d.push(ne(r));s(d)}}o()},[]);const l=o=>{console.log("Remove"),s(e=>e.slice(o,e.length))};return c("div",{className:"flex flex-col items-center justify-center min-h-screen min-w-screen bg-black-900 text-white",children:c(Z,{children:m("div",{className:"w-full px-8 sm:px-16 md:px-32 py-16 mx-auto",children:[m("div",{className:"flex flex-row w-full justify-between font-retro",children:[c(te,{}),c(_,{})]}),t.length>1&&c(ee,{words:t,onProgress:o=>null,frozen:!1,removeWords:l})]})})})}X(c(re,{}),document.getElementById("app"));
