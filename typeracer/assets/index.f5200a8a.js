import{j as U,a as Q,F as V,D as X,l as d,p as E,y as C,b as Y,C as Z,c as _,s as ee,K as te,S as ne}from"./vendor.6c86f508.js";const re=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const t of r.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&u(t)}).observe(document,{childList:!0,subtree:!0});function l(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(e){if(e.ep)return;e.ep=!0;const r=l(e);fetch(e.href,r)}};re();const s=U,v=Q,D=V,z=X({}),j=()=>Y(z),B=(n,o)=>{switch(o){case"increment":return n+1;case"decrement":return n-1;case"reset":return 0;default:throw new Error("Unexpected action")}},$=(n,o)=>n+o,oe=({children:n,encKey:o})=>{const[l,u]=d(0),[e,r]=E(B,0),[t,f]=E(B,0),[a,c]=E($,0),[x,b]=E($,0),[h,g]=E(B,0),[M,L]=d(!1),[A,O]=d([]),G=i=>O([...A,...i]),[P,N]=d(0),[S,y]=d(0);C(()=>{if(x>0&&t>0){const i=(2*x-h)/x,p=e/t,m=i*p*100;N(m),y(h/5*2*Math.min(m,1))}else N(0),y(0)},[t]);const I=()=>{var m;let i=Z.AES.encrypt(JSON.stringify({startTime:l,wordsCount:e,charCount:a,expectedWordsCount:t,expectedCharCount:x,strokeCount:h,inputs:A,accuracy:P}),o).toString(),p=_.gzip(i);(m=window==null?void 0:window.top)==null||m.postMessage({score:Math.round(S*100),d:p},"*")};return s(z.Provider,{value:{startTime:l,wordsCount:e,charCount:a,expectedCharCount:x,strokeCount:h,gameStopped:M,inputs:A,wpm:S,accuracy:P,expectedWordsCount:t,mutateWordsCount:r,mutateCharCount:c,mutateExpectedCount:b,mutateStrokeCount:g,mutateExpectedWordsCount:f,stopGame:()=>L(!0),startGame:()=>u(Date.now()/1e3),appendInputs:G,uploadGameplay:I},children:n})},se=()=>{const{wordsCount:n,charCount:o,expectedCharCount:l,strokeCount:u,wpm:e,accuracy:r}=j(),t=e/100,f=Math.round(255-(255-76)*t),a=Math.round(255-(255-198)*t),c=Math.round(255-(255-103)*t);return s(D,{children:v("span",{style:{color:`rgb(${f}, ${a}, ${c})`},children:["WPM: ",e.toFixed(2)," (",r.toFixed(2),"%)"]})})},K=({divRef:n,word:o,wordProgress:l,isProcessing:u})=>v("div",{ref:n,children:[o.split("").map((e,r)=>s("span",{className:u&&l.length>r?o[r]==l.charAt(r)?"text-success":"text-danger":"",children:e})),l.slice(o.length).split("").map(e=>s("span",{className:"text-danger",children:e})),s("span",{children:"\xA0"})]}),ae=({words:n,onProgress:o,frozen:l,removeWords:u})=>{const[e,r]=d(n[0]),[t,f]=d(""),[a,c]=d([]),[x,b]=d(0),h=14.35,g=ee(null),{startTime:M,startGame:L,mutateWordsCount:A,mutateCharCount:O,mutateExpectedWordsCount:G,mutateExpectedCount:P,mutateStrokeCount:N,appendInputs:S,gameStopped:y,uploadGameplay:I}=j();return C(()=>{var i,p,m,F,R;if(M==0&&t.length>0&&L(),t[t.length-1]==" "&&t.length!=1){t.trim()==e&&A("increment"),O(t.length),P(e.length+1),G("increment");let H=n.indexOf(e)+1;r(n[H]),f("");const J=(p=(i=g.current)==null?void 0:i.getBoundingClientRect().left)!=null?p:-1,q=(R=(F=(m=g.current)==null?void 0:m.nextElementSibling)==null?void 0:F.getBoundingClientRect().left)!=null?R:0;if(J>q){let W=0,w=g.current;for(;w;)W++,w=w.previousElementSibling;S([...a,t.trim()]),c([]),b(0),u(W)}else{c(w=>[...w,t.trim()]);let W;t.trim().length>e.length?W=t.length-1:W=e.length,b(w=>w+W+1)}}},[t]),C(()=>{y&&I()},[y]),v(D,{children:[s(te,{isDisabled:y,handleKeys:["alphabetic","backspace","space"],onKeyEvent:(i,p)=>{i=="space"&&(i=" "),i=="backspace"?f(m=>m.slice(0,m.length-1)):(N("increment"),f(m=>m+i))}}),v("div",{className:"relative w-full h-[128px]",children:[s("div",{className:"border-l-4 border-l-grey border-opacity-75 h-[2rem] absolute animate-pulse transition-all",style:{left:(t.length+x)*h+"px"}}),v("div",{className:"flex flex-row font-mono select-none flex-wrap max-h-[128px] overflow-hidden text-2xl absolute",children:[n.slice(0,a.length).map((i,p)=>s(K,{word:i,wordProgress:a[p],isProcessing:!0})),s(K,{divRef:g,word:n[a.length],wordProgress:t.trim(),isProcessing:!0}),n.slice(a.length+1,a.length+50).map((i,p)=>s(K,{word:i,wordProgress:"",isProcessing:!1}))]})]}),s("button",{onClick:()=>location.reload(),className:"bg-gray-600 text-white font-mono w-full p-2 rounded text-center cursor-pointer mt-4 "+(y?"":"hidden"),children:"Klik di sini untuk refresh dan memulai ulang."})]})},T=({children:n})=>s("p",{className:"py-[64px] font-retro w-full text-center text-xl text-white animate-pulse",children:n}),ce=()=>{const[n,o]=d(30),[l,u]=d(0),{startTime:e,stopGame:r}=j();return C(()=>{e!=0&&u(setInterval(()=>{o(t=>t-1)},1e3))},[e]),C(()=>{n>0||(r(),clearInterval(l))},[n]),s("div",{className:"font-retro text-lemon",children:n})};function ie(n){let o=Math.floor(Math.random()*n.length);return n[o]}const k={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return k.Android()||k.BlackBerry()||k.iOS()||k.Opera()||k.Windows()}};function le(){const[n,o]=d(!0),[l,u]=d("default-key"),[e,r]=d([]),t=k.any();C(()=>{var a;window.addEventListener("message",c=>{console.log("New message: "+c.data),c.data.startsWith("k:")&&(u(c.data.split("k:")[1]),console.log("Received key: "+l)),c.data=="reload"&&window.location.reload()}),(a=window==null?void 0:window.top)==null||a.postMessage("ready","*")},[]),C(()=>{async function a(){let c=await fetch("./words.txt");if(c.ok){let b=(await c.text()).split(`
`),h=[];for(let g=0;g<500;g++)h.push(ie(b));r(h),o(!1)}}a()},[]);const f=a=>{console.log("Remove"),r(c=>c.slice(a,c.length))};return s("div",{className:"flex flex-col items-center justify-center min-h-screen min-w-screen bg-black-900 text-white",children:s(oe,{encKey:l,children:v("div",{className:"w-full px-8 sm:px-16 md:px-32 py-16 mx-auto",children:[v("div",{className:"flex flex-row w-full justify-between font-retro",children:[s(ce,{}),s(se,{})]}),t?s(T,{children:"Game ini hanya dapat dimainkan pada Desktop."}):!n&&e.length>1?s(ae,{words:e,onProgress:a=>null,frozen:!1,removeWords:f}):s(T,{children:"Loading..."})]})})})}ne(s(le,{}),document.getElementById("app"));
