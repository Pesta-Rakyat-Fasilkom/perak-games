import{j as M,a as z,F as H,D as q,l as u,p as b,b as U,s as J,y,K as Q,S as V}from"./vendor.83355b46.js";const X=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function l(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=l(e);fetch(e.href,n)}};X();const c=M,h=z,Y=H,A=q({}),S=()=>U(A),j=(t,s)=>{switch(s){case"increment":return t+1;case"decrement":return t-1;case"reset":return 0;default:throw new Error("Unexpected action")}},O=(t,s)=>t+s,Z=({children:t})=>{const[s,l]=u(0),[o,e]=b(j,0),[n,r]=b(O,0),[d,i]=b(O,0),[C,w]=b(j,0),[v,E]=u(!1),[m,N]=u([]),W=I=>N([...m,...I]);return c(A.Provider,{value:{startTime:s,wordsCount:o,charCount:n,expectedCharCount:d,strokeCount:C,gameStopped:v,inputs:m,mutateWordsCount:e,mutateCharCount:r,mutateExpectedCount:i,mutateStrokeCount:w,stopGame:()=>E(!0),startGame:()=>l(Date.now()/1e3),appendInputs:W},children:t})},_=()=>{const{wordsCount:t,charCount:s,expectedCharCount:l,strokeCount:o}=S();return h("div",{className:"font-retro",children:[t,"/",l,"/",s,"/",o]})},P=({divRef:t,word:s,wordProgress:l,isProcessing:o})=>h("div",{ref:t,children:[s.split("").map((e,n)=>c("span",{className:o&&l.length>n?s[n]==l.charAt(n)?"text-success":"text-danger":"",children:l.length>n?l.charAt(n):e})),l.slice(s.length).split("").map(e=>c("span",{className:"text-danger",children:e})),c("span",{children:"\xA0"})]}),ee=({words:t,onProgress:s,frozen:l,removeWords:o})=>{const[e,n]=u(t[0]),[r,d]=u(""),[i,C]=u([]),[w,v]=u(0),E=14.35,m=J(null),{startTime:N,startGame:W,mutateWordsCount:I,mutateCharCount:R,mutateExpectedCount:k,mutateStrokeCount:F,appendInputs:K,gameStopped:T}=S();return y(()=>{var a,g,f,G,L;if(N==0&&r.length>0&&W(),r[r.length-1]==" "&&r.length!=1){r.trim()==e&&I("increment"),R(r.length),k(e.length+1);let $=t.indexOf(e)+1;n(t[$]),d("");const B=(g=(a=m.current)==null?void 0:a.getBoundingClientRect().left)!=null?g:-1,D=(L=(G=(f=m.current)==null?void 0:f.nextElementSibling)==null?void 0:G.getBoundingClientRect().left)!=null?L:0;if(B>D){let x=0,p=m.current;for(;p;)x++,p=p.previousElementSibling;K([...i,r.trim()]),C([]),v(0),o(x)}else{C(p=>[...p,r.trim()]);let x;r.trim().length>e.length?x=r.length-1:x=e.length,v(p=>p+x+1)}}},[r]),h(Y,{children:[c(Q,{isDisabled:T,handleKeys:["alphabetic","backspace","space"],onKeyEvent:(a,g)=>{a=="space"&&(a=" "),a=="backspace"?d(f=>f.slice(0,f.length-1)):(F("increment"),d(f=>f+a)),console.log(r+a)}}),h("div",{className:"relative w-full h-[128px]",children:[c("div",{className:"border-l-4 border-l-grey border-opacity-75 h-[2rem] absolute animate-pulse transition-all",style:{left:(r.length+w)*E+"px"}}),h("div",{className:"flex flex-row font-mono select-none flex-wrap max-h-[128px] overflow-hidden text-2xl absolute",children:[t.slice(0,i.length).map((a,g)=>c(P,{word:a,wordProgress:i[g],isProcessing:!0})),c(P,{divRef:m,word:t[i.length],wordProgress:r.trim(),isProcessing:!0}),t.slice(i.length+1,i.length+50).map((a,g)=>c(P,{word:a,wordProgress:"",isProcessing:!1}))]})]})]})},te=()=>{const[t,s]=u(30),[l,o]=u(0),{startTime:e,stopGame:n}=S();return y(()=>{e!=0&&o(setInterval(()=>{s(r=>r-1)},1e3))},[e]),y(()=>{t>0||(n(),clearInterval(l))},[t]),c("div",{className:"font-retro",children:t})};function ne(t){let s=Math.floor(Math.random()*t.length);return t[s]}function re(){const[t,s]=u([]);y(()=>{async function o(){let e=await fetch("/words.txt");if(e.ok){let r=(await e.text()).split(`
`),d=[];for(let i=0;i<500;i++)d.push(ne(r));s(d)}}o()},[]);const l=o=>{console.log("Remove"),s(e=>e.slice(o,e.length))};return c("div",{className:"flex flex-col items-center justify-center min-h-screen min-w-screen bg-black-900 text-white",children:c(Z,{children:h("div",{className:"w-full px-8 sm:px-16 md:px-32 py-16 mx-auto",children:[h("div",{className:"flex flex-row w-full justify-between",children:[c(te,{}),c(_,{})]}),t.length>1&&c(ee,{words:t,onProgress:o=>null,frozen:!1,removeWords:l})]})})})}V(c(re,{}),document.getElementById("app"));
