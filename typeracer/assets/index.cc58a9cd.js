import{j as H,a as q,F as U,D as J,l as i,p as W,y as w,b as Q,s as V,K as X,S as Y}from"./vendor.83355b46.js";const Z=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function c(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=c(e);fetch(e.href,t)}};Z();const l=H,m=q,T=U,$=J({}),k=()=>Q($),F=(n,s)=>{switch(s){case"increment":return n+1;case"decrement":return n-1;case"reset":return 0;default:throw new Error("Unexpected action")}},M=(n,s)=>n+s,_=({children:n})=>{const[s,c]=i(0),[o,e]=W(F,0),[t,r]=W(F,0),[f,u]=W(M,0),[p,A]=W(M,0),[C,S]=W(F,0),[v,G]=i(!1),[E,L]=i([]),N=h=>L([...E,...h]),[P,b]=i(0),[j,I]=i(0);return w(()=>{if(p>0&&t>0){const h=(2*p-C)/p,a=o/t,d=h*a*100;b(d),I(C/5*2*Math.min(d,1))}else b(0),I(0)},[t]),l($.Provider,{value:{startTime:s,wordsCount:o,charCount:f,expectedCharCount:p,strokeCount:C,gameStopped:v,inputs:E,wpm:j,accuracy:P,expectedWordsCount:t,mutateWordsCount:e,mutateCharCount:u,mutateExpectedCount:A,mutateStrokeCount:S,mutateExpectedWordsCount:r,stopGame:()=>G(!0),startGame:()=>c(Date.now()/1e3),appendInputs:N},children:n})},ee=()=>{const{wordsCount:n,charCount:s,expectedCharCount:c,strokeCount:o,wpm:e,accuracy:t}=k();return m(T,{children:[m("span",{children:["WPM: ",e.toFixed(2)," (",t.toFixed(2),"%)"]}),m("span",{children:[n,"/",c,"/",s,"/",o]})]})},O=({divRef:n,word:s,wordProgress:c,isProcessing:o})=>m("div",{ref:n,children:[s.split("").map((e,t)=>l("span",{className:o&&c.length>t?s[t]==c.charAt(t)?"text-success":"text-danger":"",children:c.length>t?c.charAt(t):e})),c.slice(s.length).split("").map(e=>l("span",{className:"text-danger",children:e})),l("span",{children:"\xA0"})]}),te=({words:n,onProgress:s,frozen:c,removeWords:o})=>{const[e,t]=i(n[0]),[r,f]=i(""),[u,p]=i([]),[A,C]=i(0),S=14.35,v=V(null),{startTime:G,startGame:E,mutateWordsCount:L,mutateCharCount:N,mutateExpectedWordsCount:P,mutateExpectedCount:b,mutateStrokeCount:j,appendInputs:I,gameStopped:h}=k();return w(()=>{var a,d,g,R,K;if(G==0&&r.length>0&&E(),r[r.length-1]==" "&&r.length!=1){r.trim()==e&&L("increment"),N(r.length),b(e.length+1),P("increment");let B=n.indexOf(e)+1;t(n[B]),f("");const D=(d=(a=v.current)==null?void 0:a.getBoundingClientRect().left)!=null?d:-1,z=(K=(R=(g=v.current)==null?void 0:g.nextElementSibling)==null?void 0:R.getBoundingClientRect().left)!=null?K:0;if(D>z){let y=0,x=v.current;for(;x;)y++,x=x.previousElementSibling;I([...u,r.trim()]),p([]),C(0),o(y)}else{p(x=>[...x,r.trim()]);let y;r.trim().length>e.length?y=r.length-1:y=e.length,C(x=>x+y+1)}}},[r]),w(()=>{h&&(N(r.length),b(e.length+1),P("increment"))},[h]),m(T,{children:[l(X,{isDisabled:h,handleKeys:["alphabetic","backspace","space"],onKeyEvent:(a,d)=>{a=="space"&&(a=" "),a=="backspace"?f(g=>g.slice(0,g.length-1)):(j("increment"),f(g=>g+a))}}),m("div",{className:"relative w-full h-[128px]",children:[l("div",{className:"border-l-4 border-l-grey border-opacity-75 h-[2rem] absolute animate-pulse transition-all",style:{left:(r.length+A)*S+"px"}}),m("div",{className:"flex flex-row font-mono select-none flex-wrap max-h-[128px] overflow-hidden text-2xl absolute",children:[n.slice(0,u.length).map((a,d)=>l(O,{word:a,wordProgress:u[d],isProcessing:!0})),l(O,{divRef:v,word:n[u.length],wordProgress:r.trim(),isProcessing:!0}),n.slice(u.length+1,u.length+50).map((a,d)=>l(O,{word:a,wordProgress:"",isProcessing:!1}))]})]})]})},ne=()=>{const[n,s]=i(30),[c,o]=i(0),{startTime:e,stopGame:t}=k();return w(()=>{e!=0&&o(setInterval(()=>{s(r=>r-1)},1e3))},[e]),w(()=>{n>0||(t(),clearInterval(c))},[n]),l("div",{className:"font-retro",children:n})};function re(n){let s=Math.floor(Math.random()*n.length);return n[s]}function se(){const[n,s]=i([]);w(()=>{async function o(){let e=await fetch("./words.txt");if(e.ok){let r=(await e.text()).split(`
`),f=[];for(let u=0;u<500;u++)f.push(re(r));s(f)}}o()},[]);const c=o=>{console.log("Remove"),s(e=>e.slice(o,e.length))};return l("div",{className:"flex flex-col items-center justify-center min-h-screen min-w-screen bg-black-900 text-white",children:l(_,{children:m("div",{className:"w-full px-8 sm:px-16 md:px-32 py-16 mx-auto",children:[m("div",{className:"flex flex-row w-full justify-between font-retro",children:[l(ne,{}),l(ee,{})]}),n.length>1&&l(te,{words:n,onProgress:o=>null,frozen:!1,removeWords:c})]})})})}Y(l(se,{}),document.getElementById("app"));
