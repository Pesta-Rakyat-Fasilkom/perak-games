import{j as q,a as z,F as U,D as Q,l,p as P,y as b,b as V,C as X,c as Y,s as Z,K as _,S as ee}from"./vendor.6c86f508.js";const te=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&u(r)}).observe(document,{childList:!0,subtree:!0});function a(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function u(e){if(e.ep)return;e.ep=!0;const n=a(e);fetch(e.href,n)}};te();const s=q,C=z,T=U,$=Q({}),j=()=>V($),B=(t,o)=>{switch(o){case"increment":return t+1;case"decrement":return t-1;case"reset":return 0;default:throw new Error("Unexpected action")}},F=(t,o)=>t+o,ne=({children:t,encKey:o})=>{const[a,u]=l(0),[e,n]=P(B,0),[r,h]=P(B,0),[d,c]=P(F,0),[g,x]=P(F,0),[f,W]=P(B,0),[L,O]=l(!1),[N,G]=l([]),I=m=>G([...N,...m]),[S,w]=l(0),[M,i]=l(0);b(()=>{if(g>0&&r>0){const m=(2*g-f)/g,k=e/r,y=m*k*100;w(y),i(f/5*2*Math.min(y,1))}else w(0),i(0)},[r]);const p=()=>{var y;let m=X.AES.encrypt(JSON.stringify({startTime:a,wordsCount:e,charCount:d,expectedWordsCount:r,expectedCharCount:g,strokeCount:f,inputs:N,accuracy:S}),o).toString(),k=Y.gzip(m);(y=window==null?void 0:window.top)==null||y.postMessage({score:Math.round(M*100),d:k},"*")};return s($.Provider,{value:{startTime:a,wordsCount:e,charCount:d,expectedCharCount:g,strokeCount:f,gameStopped:L,inputs:N,wpm:M,accuracy:S,expectedWordsCount:r,mutateWordsCount:n,mutateCharCount:c,mutateExpectedCount:x,mutateStrokeCount:W,mutateExpectedWordsCount:h,stopGame:()=>O(!0),startGame:()=>u(Date.now()/1e3),appendInputs:I,uploadGameplay:p},children:t})},re=()=>{const{wordsCount:t,charCount:o,expectedCharCount:a,strokeCount:u,wpm:e,accuracy:n}=j(),r=e/100,h=Math.round(255-(255-76)*r),d=Math.round(255-(255-198)*r),c=Math.round(255-(255-103)*r);return s(T,{children:C("span",{style:{color:`rgb(${h}, ${d}, ${c})`},children:["WPM: ",e.toFixed(2)," (",n.toFixed(2),"%)"]})})},K=({divRef:t,word:o,wordProgress:a,isProcessing:u})=>C("div",{ref:t,children:[o.split("").map((e,n)=>s("span",{className:u&&a.length>n?o[n]==a.charAt(n)?"text-success":"text-danger":"",children:e})),a.slice(o.length).split("").map(e=>s("span",{className:"text-danger",children:e})),s("span",{children:"\xA0"})]}),oe=({words:t,removeWords:o})=>{const[a,u]=l(t[0]),[e,n]=l(""),[r,h]=l([]),[d,c]=l(0),g=14.35,x=Z(null),{startTime:f,startGame:W,mutateWordsCount:L,mutateCharCount:O,mutateExpectedWordsCount:N,mutateExpectedCount:G,mutateStrokeCount:I,appendInputs:S,gameStopped:w,uploadGameplay:M}=j();return b(()=>{var i,p,m,k,y;if(f==0&&e.length>0&&W(),e[e.length-1]==" "&&e.length!=1){e.trim()==a&&L("increment"),O(e.length),G(a.length+1),N("increment");let D=t.indexOf(a)+1;u(t[D]),n("");const H=(p=(i=x.current)==null?void 0:i.getBoundingClientRect().left)!=null?p:-1,J=(y=(k=(m=x.current)==null?void 0:m.nextElementSibling)==null?void 0:k.getBoundingClientRect().left)!=null?y:0;if(H>J){let A=0,v=x.current;for(;v;)A++,v=v.previousElementSibling;S([...r,e.trim()]),h([]),c(0),o(A)}else{h(v=>[...v,e.trim()]);let A;e.trim().length>a.length?A=e.length-1:A=a.length,c(v=>v+A+1)}}},[e]),b(()=>{w&&M()},[w]),C(T,{children:[s(_,{isDisabled:w,handleKeys:["alphabetic","backspace","space"],onKeyEvent:(i,p)=>{p.preventDefault(),!!p.isTrusted&&(i=="space"&&(i=" "),i=="backspace"?n(m=>m.slice(0,m.length-1)):(I("increment"),n(m=>m+i)))}}),C("div",{className:"relative w-full h-[128px]",children:[s("div",{className:"border-l-4 border-l-grey border-opacity-75 h-[2rem] absolute animate-pulse transition-all",style:{left:(e.length+d)*g+"px"}}),C("div",{className:"flex flex-row font-mono select-none flex-wrap max-h-[128px] overflow-hidden text-2xl absolute",children:[t.slice(0,r.length).map((i,p)=>s(K,{word:i,wordProgress:r[p],isProcessing:!0})),s(K,{divRef:x,word:t[r.length],wordProgress:e.trim(),isProcessing:!0}),t.slice(r.length+1,r.length+50).map((i,p)=>s(K,{word:i,wordProgress:"",isProcessing:!1}))]})]}),s("button",{onClick:()=>location.reload(),className:"bg-gray-600 text-white font-mono w-full p-2 rounded text-center cursor-pointer mt-4 "+(w?"":"hidden"),children:"Klik di sini untuk refresh dan memulai ulang."})]})},R=({children:t})=>s("p",{className:"py-[64px] font-retro w-full text-center text-xl text-white animate-pulse",children:t}),se=()=>{const[t,o]=l(30),[a,u]=l(0),{startTime:e,stopGame:n}=j();return b(()=>{e!=0&&u(setInterval(()=>{o(r=>r-1)},1e3))},[e]),b(()=>{t>0||(n(),clearInterval(a))},[t]),s("div",{className:"font-retro text-lemon",children:t})};function ae(t){let o=Math.floor(Math.random()*t.length);return t[o]}const E={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return E.Android()||E.BlackBerry()||E.iOS()||E.Opera()||E.Windows()}};function ce(){const[t,o]=l(!0),[a,u]=l("default-key"),[e,n]=l([]),r=E.any();b(()=>{var d;window.addEventListener("message",c=>{console.log("New message: "+c.data),c.data.startsWith("k:")&&(u(c.data.split("k:")[1]),console.log("Received key: "+a)),c.data=="reload"&&window.location.reload()}),(d=window==null?void 0:window.top)==null||d.postMessage("ready","*")},[]),b(()=>{async function d(){let c=await fetch("./words.txt");if(c.ok){let x=(await c.text()).split(`
`),f=[];for(let W=0;W<500;W++)f.push(ae(x));n(f),o(!1)}}d()},[]);const h=d=>{console.log("Remove"),n(c=>c.slice(d,c.length))};return s("div",{className:"flex flex-col items-center justify-center min-h-screen min-w-screen bg-black-900 text-white",children:s(ne,{encKey:a,children:C("div",{className:"w-full px-8 sm:px-16 md:px-32 2xl:px-64 py-16 mx-auto",children:[C("div",{className:"flex flex-row w-full justify-between font-retro",children:[s(se,{}),s(re,{})]}),r?s(R,{children:"Game ini hanya dapat dimainkan pada Desktop."}):!t&&e.length>1?s(oe,{words:e,removeWords:h}):s(R,{children:"Loading..."})]})})})}ee(s(ce,{}),document.getElementById("app"));
